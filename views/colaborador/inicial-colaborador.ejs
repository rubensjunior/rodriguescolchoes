<!-- Wappler include head-page="layouts/mobile-portaria" fontawesome_5="cdn" bootstrap5="local" is="dmx-app" id="inicialcolaborador" appConnect="local" components="{dmxBootstrap5Offcanvas:{},dmxFormatter:{},dmxDataTraversal:{}}" -->

<style>
    /* Estilo para imagem de perfil no offcanvas QR Code - mesma largura do QR Code */
    .profile-image {
        width: 280px !important;
        height: 350px !important;
        /* Propor√ß√£o 4:5 (280x350) */
        max-width: 280px !important;
        max-height: 350px !important;
        border-radius: 8px;
        object-fit: cover;
        border: 4px solid #fff;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        margin-bottom: 1rem;
        display: block !important;
        transition: all 0.3s ease;
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        margin-left: auto !important;
        margin-right: auto !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative;
    }

    .profile-image::before {
        content: "üì∑";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 2rem;
        color: #1976d2;
        z-index: 1;
    }

    .profile-image[src]:not([src=""]) {
        background: none;
    }

    .profile-image[src]:not([src=""])::before {
        display: none;
    }

    .profile-image:hover {
        transform: scale(1.02);
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    /* Tablet - mesma largura do QR Code tablet */
    @media (min-width: 768px) and (max-width: 991.98px) {
        .profile-image {
            width: 300px !important;
            height: 375px !important;
            /* Propor√ß√£o 4:5 (300x375) */
            max-width: 300px !important;
            max-height: 375px !important;
        }

        .profile-image::before {
            font-size: 2.2rem;
        }
    }

    /* Desktop - mesma largura do QR Code desktop */
    @media (min-width: 992px) {
        .profile-image {
            width: 320px !important;
            height: 400px !important;
            /* Propor√ß√£o 4:5 (320x400) */
            max-width: 320px !important;
            max-height: 400px !important;
        }

        .profile-image::before {
            font-size: 2.5rem;
        }
    }

    /* Mobile - mesma largura do QR Code mobile */
    @media (max-width: 767.98px) {
        .profile-image {
            width: 250px !important;
            height: 312px !important;
            /* Propor√ß√£o 4:5 (250x312) */
            max-width: 250px !important;
            max-height: 312px !important;
        }

        .profile-image::before {
            font-size: 1.8rem;
        }
    }

    /* Mobile pequeno - mesma largura do QR Code mobile pequeno */
    @media (max-width: 575.98px) {
        .profile-image {
            width: 220px !important;
            height: 275px !important;
            /* Propor√ß√£o 4:5 (220x275) */
            max-width: 220px !important;
            max-height: 275px !important;
        }

        .profile-image::before {
            font-size: 1.5rem;
        }
    }
</style>


<dmx-data-detail id="data_detail_veiculo" dmx-bind:data="usuario_logado.data.query_acesso_veiculo" key="id_veiculo"></dmx-data-detail>
<div class="offcanvas offcanvas-start" id="offcanvas_qrcode" is="dmx-bs5-offcanvas" tabindex="-1">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Meu QR Code</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body text-center">
        <img class="profile-image" dmx-bind:src="usuario_logado.data.query_colaborador.imagem_perfil.replace('/public', '')" alt="Foto do Colaborador" onerror="this.style.border='4px solid #f44336'; this.style.background='#ffebee';">

        <img dmx-bind:src="'data:image/png;base64,' + usuario_logado.data.query_colaborador.base64" class="img-fluid qr-code-image mb-3" alt="QR Code de Acesso">
        <h5 class="text-start">Nome: {{usuario_logado.data.query_colaborador.nome_colaborador}}</h5>
        <h5 class="text-start">CPF: {{data_detail_veiculo.data.cpf_colaborador}}</h5>
    </div>
</div>

<div class="offcanvas offcanvas-start" id="offcanvas_veiculos" is="dmx-bs5-offcanvas" tabindex="-1">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Meu ve√≠culo</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body text-center">
        <img dmx-bind:src="'data:image/png;base64,'+data_detail_veiculo.data.base64_veiculo" class="img-fluid qr-code-image mb-4" alt="QR Code de Acesso">
        <h5 class="text-start">Ve√≠culo: {{data_detail_veiculo.data.modelo_veiculo}}</h5>
        <h5 class="text-start">Placa: {{data_detail_veiculo.data.placa_veiculo}}</h5>
        <h5 class="text-start">Cor: {{data_detail_veiculo.data.cor_veiculo}}</h5>
    </div>
</div>
<div class="container-fluid px-4">
    <div class="row align-items-center gy-3">
        <div class="col-12">
            <h3 class="text-start" id="usuario">Bem-vindo(a) {{usuario_logado.data.query_colaborador.nome_colaborador.split(' ').first()}}</h3>
        </div>
        <div class="col-12 p-3 rounded-3 text-center border">
            <i class="fas fa-qrcode text-dark fa-2x mb-3"></i>
            <h4 class="mb-3">Meu QR Code</h4>
            <button id="btn1" class="btn w-100 btn-primary" data-bs-toggle="offcanvas" data-bs-target="#offcanvas_qrcode">Exibir QR Code</button>
        </div>
        <div class="col-12 p-3 rounded-3 text-center border">
            <i class="fas fa-car fa-2x mb-3"></i>
            <h4 class="mb-3">Meus ve√≠culos</h4>
            <select id="select1" class="form-select mb-3" dmx-bind:options="usuario_logado.data.query_acesso_veiculo" optionvalue="id_veiculo" optiontext="modelo_veiculo+' - '+placa_veiculo">
                <option value="">Selecione</option>
            </select>
            <button id="btn2" class="btn btn-primary w-100" dmx-on:click="data_detail_veiculo.select(select1.selectedValue);offcanvas_veiculos.show()">Selecionar Ve√≠culo</button>
        </div>
    </div>
</div>
<meta name="ac:route" content="/colaborador/f/">